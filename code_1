from reportlab.lib.pagesizes import landscape, letter
from reportlab.pdfgen import canvas
from reportlab.pdfbase.pdfmetrics import stringWidth

def text_to_pdf(input_file, output_file):
    page_width, page_height = landscape(letter)
    c = canvas.Canvas(output_file, pagesize=(page_width, page_height))

    font_name = "Courier"
    font_size = 11
    line_height = 15
    margin = 40
    max_width = page_width - 2 * margin

    c.setFont(font_name, font_size)

    try:
        with open(input_file, "r") as f:
            lines = f.readlines()
    except FileNotFoundError:
        print("Error: Input file not found.")
        return

    y = page_height - margin

    for line in lines:
        line = line.rstrip()
        text_width = stringWidth(line, font_name, font_size)

        # Auto scale if line is too long
        if text_width > max_width:
            scale = max_width / text_width
            c.saveState()
            c.translate(margin, y)
            c.scale(scale, 1)
            c.drawString(0, 0, line)
            c.restoreState()
        else:
            c.drawString(margin, y, line)

        y -= line_height
        if y < margin:
            c.showPage()
            c.setFont(font_name, font_size)
            y = page_height - margin

    c.save()
    print("ðŸ“„ PDF created with smart line scaling!")

if __name__ == "__main__":
    import sys
    if len(sys.argv) != 3:
        print("Usage: python txt2pdf.py <input_file.txt> <output_file.pdf>")
    else:
        text_to_pdf(sys.argv[1], sys.argv[2])
